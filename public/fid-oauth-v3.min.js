(()=>{function e(e,r,t,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void t(e)}s.done?r(c):Promise.resolve(c).then(n,o)}function r(r){return function(){var t=this,n=arguments;return new Promise((function(o,i){var a=r.apply(t,n);function s(r){e(a,o,i,s,c,"next",r)}function c(r){e(a,o,i,s,c,"throw",r)}s(void 0)}))}}window.FtechFID=new function(){var e=this;this.mgr=null,this.URL="https://id-dev.ftech.ai/",this.init=function(r){var t=r.authority,n=r.client_id,o=(r.client_secret,r.redirect_uri),i=r.post_logout_redirect_uri,a=void 0===i?window.location.origin:i,s=r.response_type,c=void 0===s?"code":s,u=r.scope,p=void 0===u?"openid profile offline_access":u,g=r.filterProtocolClaims,l=void 0===g||g,f=r.loadUserInfo,h=void 0===f||f,d=r.popupWindowFeatures,w=r.popupWindowTarget;if(e.URL=t.endsWith("/")?t:t+"/",!t||!n||!o)throw new Error("You are missing authority or client_id or client_secret or redirect_uri");var v=new Oidc.UserManager({authority:t,client_id:n,redirect_uri:o,post_logout_redirect_uri:a,response_type:c,scope:p,filterProtocolClaims:l,loadUserInfo:h,popupWindowFeatures:d,popupWindowTarget:w}),m=v._popupNavigator.prepare;v._popupNavigator.prepare=function(){return m.apply(this,arguments).then((function(e){return v.signinPopupInstance=e,Promise.resolve(e)}))},e.mgr=v},this.login=function(){return e.mgr&&e.mgr.signinRedirect()},this.getUser=function(r){try{var t=e.mgr;if(!e.mgr)throw new Error("You are not login!");t.getUser().then((function(e){var t=this.URL+"connect/userinfo",n=new XMLHttpRequest;n.open("GET",t),n.onload=function(){log(n.status,JSON.parse(n.responseText)),r&&r(n.responseText)},n.setRequestHeader("Authorization","Bearer "+e.access_token),n.send()}))}catch(e){throw new Error("get user exception")}},this.getUserAsync=r(regeneratorRuntime.mark((function r(){var t,n,o,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,t=e.mgr,e.mgr){r.next=4;break}throw new Error("You are not login!");case 4:return r.next=6,t.getUser();case 6:if(!(n=r.sent)){r.next=15;break}return o=e.URL+"connect/userinfo",r.next=11,fetch(o,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+n.access_token}});case 11:return i=r.sent,r.next=14,i.json();case 14:return r.abrupt("return",r.sent);case 15:return r.abrupt("return",{});case 18:throw r.prev=18,r.t0=r.catch(0),new Error("get user exception");case 21:case"end":return r.stop()}}),r,null,[[0,18]])}))),this.logout=function(){if(!e.mgr)throw new Error("You are not login!");e.mgr.signoutRedirect()},this.getIDToken=r(regeneratorRuntime.mark((function r(){var t,n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,t=e.mgr,e.mgr){r.next=4;break}throw new Error("You are not login!");case 4:return r.next=6,t.getUser();case 6:if(!(n=r.sent)){r.next=9;break}return r.abrupt("return",null==n?void 0:n.id_token);case 9:r.next=13;break;case 11:r.prev=11,r.t0=r.catch(0);case 13:case"end":return r.stop()}}),r,null,[[0,11]])}))),this.getRefreshToken=r(regeneratorRuntime.mark((function r(){var t,n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,t=e.mgr,e.mgr){r.next=4;break}throw new Error("You are not login!");case 4:return r.next=6,t.getUser();case 6:if(!(n=r.sent)){r.next=9;break}return r.abrupt("return",null==n?void 0:n.refresh_token);case 9:r.next=13;break;case 11:r.prev=11,r.t0=r.catch(0);case 13:case"end":return r.stop()}}),r,null,[[0,11]])}))),this.getAccountID=r(regeneratorRuntime.mark((function r(){var t,n,o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,n=e.mgr,e.mgr){r.next=4;break}throw new Error("You are not login!");case 4:return r.next=6,n.getUser();case 6:if(!(o=r.sent)){r.next=9;break}return r.abrupt("return",null==o||null===(t=o.profile)||void 0===t?void 0:t.sub);case 9:r.next=13;break;case 11:r.prev=11,r.t0=r.catch(0);case 13:case"end":return r.stop()}}),r,null,[[0,11]])}))),this.callbackLogin=function(e){new Oidc.UserManager({response_mode:"query"}).signinRedirectCallback().then((function(){window.location=e})).catch((function(e){throw new Error(e)}))}}})();